<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>acoustotreams.special._wavesacoustics &#8212; acoustotreams 0.2.13 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=0c472235" />
    <link rel="stylesheet" type="text/css" href="../../../_static/pyramid.css?v=424f8d56" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/custom.css?v=f4ec84db" />
    <script src="../../../_static/documentation_options.js?v=ba481074"></script>
    <script src="../../../_static/doctools.js?v=fd6eb6e6"></script>
    <script src="../../../_static/sphinx_highlight.js?v=6ffebe34"></script>
    <link rel="author" title="About these documents" href="../../../about.html" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">acoustotreams 0.2.13 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" accesskey="U">Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">acoustotreams.special._wavesacoustics</a></li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for acoustotreams.special._wavesacoustics</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Special mathematical functions related to the scalar waves&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">treams.special</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">sc</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">cmath</span>

<div class="viewcode-block" id="spw_Psi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.spw_Psi.html#acoustotreams.special.spw_Psi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">spw_Psi</span><span class="p">(</span><span class="n">kx</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">kz</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Scalar plane wave :math:`\Psi` </span>

<span class="sd">    The scalar plane wave is defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \psi_{\mathbf k}(\mathbf r)</span>
<span class="sd">        = \mathrm e^{\mathrm i \mathbf k \mathbf r}.</span>

<span class="sd">    This function describes a solution to the scalar Helmholtz wave</span>
<span class="sd">    equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        kx (float or complex, array_like): X component of the wave vector</span>
<span class="sd">        ky (float or complex, array_like): Y component of the wave vector</span>
<span class="sd">        kz (float or complex, array_like): Z component of the wave vector</span>
<span class="sd">        x (float, array_like): Y coordinate</span>
<span class="sd">        y (float, array_like): X coordinate</span>
<span class="sd">        z (float, array_like): Z coordinate</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">kx</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ky</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span></div>



<div class="viewcode-block" id="vpw_L">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vpw_L.html#acoustotreams.special.vpw_L">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vpw_L</span><span class="p">(</span><span class="n">kx</span><span class="p">,</span> <span class="n">ky</span><span class="p">,</span> <span class="n">kz</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Longitudinal vector plane wave L</span>
<span class="sd">    </span>
<span class="sd">    The longitudinal vector plane wave is defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">       \mathbf L_{\mathbf k}(\mathbf r)</span>
<span class="sd">        = \frac{\mathbf k}{k} \mathrm e^{\mathrm i \mathbf k \mathbf r}.</span>

<span class="sd">    This function describes a longitudinal solution to the vector Helmholtz wave</span>
<span class="sd">    equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        kx (float or complex, array_like): X component of the wave vector</span>
<span class="sd">        ky (float or complex, array_like): Y component of the wave vector</span>
<span class="sd">        kz (float or complex, array_like): Z component of the wave vector</span>
<span class="sd">        x (float, array_like): Y coordinate</span>
<span class="sd">        y (float, array_like): X coordinate</span>
<span class="sd">        z (float, array_like): Z coordinate</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex, 3-array</span>
<span class="sd">    </span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">k</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">kx</span> <span class="o">*</span> <span class="n">kx</span> <span class="o">+</span> <span class="n">ky</span> <span class="o">*</span> <span class="n">ky</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">kz</span><span class="p">)</span>
    <span class="n">phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">kx</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">ky</span> <span class="o">*</span> <span class="n">y</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span><span class="p">])</span><span class="o">.</span><span class="n">T</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">asarray</span><span class="p">([</span><span class="n">kx</span> <span class="o">*</span> <span class="n">phase</span><span class="p">,</span> <span class="n">ky</span> <span class="o">*</span> <span class="n">phase</span><span class="p">,</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">phase</span><span class="p">],</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">/</span> <span class="n">k</span></div>


<div class="viewcode-block" id="ssw_Psi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.ssw_Psi.html#acoustotreams.special.ssw_Psi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ssw_Psi</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Singular scalar spherical wave :math:`\Psi`</span>

<span class="sd">    The singular scalar spherical wave is defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \Psi_{lm}^{(3)}(x, \theta, \varphi)</span>
<span class="sd">        = h_l^{(1)}(x) Y_{lm}(\theta, \varphi)</span>

<span class="sd">    with :func:`acoustotreams.special.sph_harm`, and :func:`acoustotreams.special.spherical_hankel1`.</span>

<span class="sd">    This function describes a solution to the scalar Helmholtz wave</span>
<span class="sd">    equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (int, array_like): Degree :math:`l \geq 0`</span>
<span class="sd">        m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">        x (float or complex, array_like): Distance in units of the wave number in the medium :math:`kr`</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">spherical_hankel1</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">kr</span><span class="p">)</span></div>


<div class="viewcode-block" id="ssw_psi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.ssw_psi.html#acoustotreams.special.ssw_psi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ssw_psi</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Far-field amplitude of singular scalar spherical wave :math:`\psi`</span>
<span class="sd">     Defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \psi_{lm}(x, y, z, \theta, \varphi)</span>
<span class="sd">        = \frac{\mathrm{i}^{-l-1}}{k} </span>
<span class="sd">        Y_{lm}(\theta, \varphi)</span>
<span class="sd">        \mathrm{e}^{-\mathrm{i} k \left(x \sin \theta \cos \varphi + y \sin \theta \sin \varphi + z \cos \theta\right)}</span>

<span class="sd">    with :func:`acoustotreams.special.sph_harm`.</span>

<span class="sd">    This function describes a solution to the vector Helmholtz wave</span>
<span class="sd">    equation in the limit of :math:`kr \to +\infty`.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (int, array_like): Degree :math:`l \geq 0`</span>
<span class="sd">        m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">        x (float or complex, array_like): X coordinate of the source</span>
<span class="sd">        y (float or complex, array_like): Y coordinate of the source</span>
<span class="sd">        z (float or complex, array_like): Z coordinate of the source</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>
<span class="sd">        k (float or complex, array_like): Wave number in the medium</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
             <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">k</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> 
                             <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span>
             <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
             <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span></div>


<div class="viewcode-block" id="ssw_rPsi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.ssw_rPsi.html#acoustotreams.special.ssw_rPsi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">ssw_rPsi</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Regular scalar spherical wave :math:`\Psi`</span>

<span class="sd">     The regular scalar spherical wave is defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \Psi_{lm}^{(1)}(x, \theta, \varphi)</span>
<span class="sd">        = j_l(x) Y_{lm}(\theta, \varphi)</span>

<span class="sd">    with :func:`acoustotreams.special.sph_harm`, and :func:`acoustotreams.special.spherical_jn`.</span>

<span class="sd">    This function describes a solution to the scalar Helmholtz wave</span>
<span class="sd">    equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (int, array_like): Degree :math:`l \geq 0`</span>
<span class="sd">        m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">        x (float or complex, array_like): Distance in units of the wave number in the medium :math:`kr`</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">kr</span><span class="p">)</span></div>



<div class="viewcode-block" id="scw_Psi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.scw_Psi.html#acoustotreams.special.scw_Psi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">scw_Psi</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Singular scalar cylindrical wave :math:`\Psi`</span>

<span class="sd">     The singular scalar cylindrical wave is defined by</span>

<span class="sd">     .. math::</span>

<span class="sd">         \psi_{k_z m}^{(3)}(x_\rho, \varphi, z)</span>
<span class="sd">        = H_m^{(1)}(x_\rho) \mathrm e^{\mathrm i (k_z z + m \varphi)}</span>

<span class="sd">     using :func:`acoustotreams.special.hankel1`.</span>

<span class="sd">     This function describes a solution to the scalar Helmholtz wave</span>
<span class="sd">     equation.</span>

<span class="sd">     Args:</span>
<span class="sd">         kz (float, array_like): Z component of the wave vector</span>
<span class="sd">         m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">         xrho (float or complex, array_like): Radial distance in units of the radial component of the wave number in the medium :math:`k_\rho \rho`</span>
<span class="sd">         phi (float, array_like): Azimuthal angle</span>
<span class="sd">         z (float, array_like): Z coordinate</span>

<span class="sd">     Returns:</span>
<span class="sd">         complex</span>
<span class="sd">      &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">hankel1</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span></div>


<div class="viewcode-block" id="scw_psi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.scw_psi.html#acoustotreams.special.scw_psi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">scw_psi</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">krho</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Far-field amplitude of singular scalar cylindrical wave :math:`\psi`</span>

<span class="sd">     Defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \psi_{k_z m}(x, y, \varphi)</span>
<span class="sd">        = \sqrt{\frac{2}{\pi k_{\rho}}} \mathrm{i}^{-m} \mathrm{e}^{-\mathrm{i} \pi/4}</span>
<span class="sd">        \mathrm{e}^{-\mathrm{i} k_{\rho} \left(x \cos \varphi + y \sin \varphi\right)}</span>
<span class="sd">        \mathrm{e}^{\mathrm{i} m \varphi + \mathrm{i} k_z z}</span>

<span class="sd">    This function describes a solution to the vector Helmholtz wave</span>
<span class="sd">    equation in the limit of :math:`k_{\rho} \rho \to +\infty`.</span>

<span class="sd">    Args:</span>
<span class="sd">        kz (float, array_like): Z component of the wave vector</span>
<span class="sd">        m (int, array_like): Order</span>
<span class="sd">        x (float or complex, array_like): X coordinate of the source</span>
<span class="sd">        y (float or complex, array_like): Y coordinate of the source</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>
<span class="sd">        z (float or complex, array_like): Z coordinate of the source</span>
<span class="sd">        krho (float or complex, array_like): Radial component of the wave vector</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">)</span> <span class="o">*</span> 
             <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">krho</span><span class="p">))</span> <span class="o">*</span>
             <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">krho</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">krho</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))))</span> <span class="o">*</span>
             <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> 
             <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">))</span></div>


<div class="viewcode-block" id="scw_rPsi">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.scw_rPsi.html#acoustotreams.special.scw_rPsi">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">scw_rPsi</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Regular scalar cylindrical wave :math:`\Psi`</span>

<span class="sd">     The regular scalar cylindrical wave is defined by</span>

<span class="sd">     .. math::</span>

<span class="sd">         \psi_{k_z m}^{(1)}(x_\rho, \varphi, z)</span>
<span class="sd">        = J_m(x_\rho) \mathrm e^{\mathrm i (k_z z + m \varphi)}</span>

<span class="sd">     using :func:`acoustotreams.special.jv`.</span>

<span class="sd">     This function describes a solution to the scalar Helmholtz wave</span>
<span class="sd">     equation.</span>

<span class="sd">     Args:</span>
<span class="sd">         kz (float, array_like): Z component of the wave vector</span>
<span class="sd">         m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">         xrho (float or complex, array_like): Radial distance in units of the radial component of the wave number in the medium :math:`k_\rho \rho`</span>
<span class="sd">         phi (float, array_like): Azimuthal angle</span>
<span class="sd">         z (float, array_like): Z coordinate</span>

<span class="sd">     Returns:</span>
<span class="sd">         complex</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">jv</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span></div>



<div class="viewcode-block" id="vsw_L">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vsw_L.html#acoustotreams.special.vsw_L">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vsw_L</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Singular longitudinal vector spherical wave L</span>

<span class="sd">     The singular vector spherical wave is defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \mathbf{L}_{lm}^{(3)}(x, \theta, \varphi)</span>
<span class="sd">        = -\mathrm{i} \left[{h_l^{(1)}}&#39;(x) \mathbf{Z}_{lm}(\theta, \varphi) </span>
<span class="sd">        + \sqrt{l(l+1)} \frac{h_l^{(1)}(x)}{x} \mathbf{Y}_{lm}(\theta, \varphi) \right]</span>

<span class="sd">    with :func:`acoustotreams.special.vsh_Z`, :func:`acoustotreams.special.vsh_Y`, </span>
<span class="sd">    :func:`acoustotreams.special.spherical_hankel1`, and :func:`acoustotreams.special.spherical_hankel1`.</span>

<span class="sd">    This function describes a solution to the vector Helmholtz wave</span>
<span class="sd">    equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (int, array_like): Degree :math:`l \geq 0`</span>
<span class="sd">        m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">        x (float or complex, array_like): Distance in units of the wave number in the medium :math:`kr`</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex, 3-array</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="n">sc</span><span class="o">.</span><span class="n">vsh_Z</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">spherical_hankel1_d</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">kr</span><span class="p">)</span>  <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
         <span class="n">l</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>
     <span class="p">)</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">vsh_Y</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">spherical_hankel1</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">kr</span><span class="p">)</span> <span class="o">/</span> <span class="n">kr</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="p">)</span></div>



<div class="viewcode-block" id="vsw_l">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vsw_l.html#acoustotreams.special.vsw_l">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vsw_l</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Far-field amplitude of singular longitudinal vector spherical wave l</span>

<span class="sd">     Defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \mathbf{l}_{lm}(x, y, z, \theta, \varphi)</span>
<span class="sd">        = \frac{\mathrm{i}^{-l}}{k} </span>
<span class="sd">        Y_{lm}(\theta, \varphi)\hat{\mathbf{r}}</span>
<span class="sd">        \mathrm{e}^{-\mathrm{i} k \left(x \sin \theta \cos \varphi + y \sin \theta \sin \varphi + z \cos \theta\right)}</span>

<span class="sd">    with :func:`acoustotreams.special.sph_harm`.</span>

<span class="sd">    This function describes a solution to the vector Helmholtz wave</span>
<span class="sd">    equation in the limit of :math:`kr \to +\infty`.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (int, array_like): Degree :math:`l \geq 0`</span>
<span class="sd">        m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">        x (float or complex, array_like): X coordinate of the source</span>
<span class="sd">        y (float or complex, array_like): Y coordinate of the source</span>
<span class="sd">        z (float or complex, array_like): Z coordinate of the source</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>
<span class="sd">        k (float or complex, array_like): Wave number in the medium</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex, 3-array</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
             <span class="p">[</span>
                 <span class="n">sc</span><span class="o">.</span><span class="n">sph_harm</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
                 <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">k</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> 
                                 <span class="o">+</span> <span class="n">k</span> <span class="o">*</span> <span class="n">z</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)))</span>
                 <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">l</span><span class="p">)</span>
                 <span class="o">*</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span> 
                 <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                 <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">T</span>
            <span class="p">]</span>
        <span class="p">)</span>
    <span class="p">)</span></div>



<div class="viewcode-block" id="vsw_rL">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vsw_rL.html#acoustotreams.special.vsw_rL">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vsw_rL</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Regular longitudinal vector spherical wave L</span>

<span class="sd">     The regular vector spherical wave is defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \mathbf{L}_{lm}^{(1)}(x, \theta, \varphi)</span>
<span class="sd">        = -\mathrm{i} \left[j_l&#39;(x) \mathbf{Z}_{lm}(\theta, \varphi) </span>
<span class="sd">        + \sqrt{l(l+1)}\frac{j_l(x)}{x} \mathbf{Y}_{lm}(\theta, \varphi) \right]</span>

<span class="sd">    with :func:`acoustotreams.special.vsh_Z`, :func:`acoustotreams.special.vsh_Y`, </span>
<span class="sd">    and :func:`acoustotreams.special.spherical_jn`.</span>

<span class="sd">    This function describes a solution to the vector Helmholtz wave</span>
<span class="sd">    equation.</span>

<span class="sd">    Args:</span>
<span class="sd">        l (int, array_like): Degree :math:`l \geq 0`</span>
<span class="sd">        m (int, array_like): Order :math:`|m| \leq l`</span>
<span class="sd">        x (float or complex, array_like): Distance in units of the wave number in the medium :math:`kr`</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex, 3-array</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">kr</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                   <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                       <span class="n">sc</span><span class="o">.</span><span class="n">vsh_Z</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">+</span> 
                       <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">vsh_Y</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">T</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span><span class="o">/</span><span class="mi">3</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="p">)</span>
                   <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>      
                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
                    <span class="n">sc</span><span class="o">.</span><span class="n">vsh_Z</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> 
                    <span class="n">sc</span><span class="o">.</span><span class="n">spherical_jn_d</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">kr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>  
                    <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> 
                    <span class="n">sc</span><span class="o">.</span><span class="n">vsh_Y</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">theta</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> 
                    <span class="n">sc</span><span class="o">.</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">l</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">kr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">kr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="p">(</span><span class="o">-</span><span class="mf">1.0</span><span class="n">j</span><span class="p">)</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>



<div class="viewcode-block" id="vcw_L">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vcw_L.html#acoustotreams.special.vcw_L">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vcw_L</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">krho</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Singular longitudinal vector cylindrical wave L</span>

<span class="sd">     The singular vector cylindrical wave is defined by</span>

<span class="sd">     .. math::</span>

<span class="sd">         \mathbf{L}_{k_z m}^{(3)}(x_\rho, \varphi, z)</span>
<span class="sd">        = \left[\frac{k_{\rho}}{k} {H^{(1)}_m(x_\rho)}&#39; \hat{\boldsymbol{\rho}} </span>
<span class="sd">        + \mathrm{i}\frac{m k_{\rho}}{k}\frac{H^{(1)}_m(x_\rho)}{k_{\rho}\rho} \hat{\boldsymbol{\varphi}} </span>
<span class="sd">        + \frac{\mathrm{i} k_z}{k}H^{(1)}_m(x_\rho) \hat{\mathbf{z}} \right] </span>
<span class="sd">        \mathrm{e}^{\mathrm{i} m \varphi + \mathrm{i} k_z z}</span>

<span class="sd">     using :func:`acoustotreams.special.hankel1_d` and :func:`acoustotreams.special.hankel1`.</span>

<span class="sd">     This function describes a longitudinal solution to the vector Helmholtz wave</span>
<span class="sd">     equation.</span>

<span class="sd">     Args:</span>
<span class="sd">         kz (float, array_like): Z component of the wave vector</span>
<span class="sd">         m (int, array_like): Order</span>
<span class="sd">         xrho (float or complex, array_like): Radial distance in units of the radial component of the wave number in the medium :math:`k_\rho \rho`</span>
<span class="sd">         phi (float, array_like): Azimuthal angle</span>
<span class="sd">         z (float, array_like): Z coordinate</span>
<span class="sd">         krho (float or complex, array_like): Radial component of the wave vector</span>
<span class="sd">         k (float or complex, array_like): Wavenumber in the medium </span>

<span class="sd">     Returns:</span>
<span class="sd">         complex, 3-array</span>
<span class="sd">      &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
             <span class="p">[</span>
                 <span class="n">sc</span><span class="o">.</span><span class="n">hankel1_d</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span> <span class="o">*</span> <span class="n">krho</span> <span class="o">/</span> <span class="n">k</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">)),</span>
                 <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">m</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">hankel1</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span> <span class="o">/</span> <span class="n">krr</span> <span class="o">*</span> <span class="n">krho</span> <span class="o">/</span> <span class="n">k</span>  <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">)),</span>
                 <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span> <span class="o">/</span> <span class="n">k</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">hankel1</span><span class="p">(</span><span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">)),</span>
             <span class="p">]</span>
         <span class="p">)</span>
     <span class="p">)</span></div>


<div class="viewcode-block" id="vcw_l">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vcw_l.html#acoustotreams.special.vcw_l">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vcw_l</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">krho</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Far-field amplitude of longitudinal singular vector cylindrical wave l</span>

<span class="sd">     Defined by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \mathbf{l}_{k_z m}(x, y, \varphi, z,)</span>
<span class="sd">        = \sqrt{\frac{2}{\pi k_{\rho}}} \mathrm{i}^{1-m} \mathrm{e}^{-\mathrm{i} \pi/4}</span>
<span class="sd">        \left(\frac{k_{\rho}}{k} \hat{\boldsymbol{\rho}} </span>
<span class="sd">         + \frac{k_{z}}{k} \hat{\mathbf{z}} \right)</span>
<span class="sd">        \mathrm{e}^{-\mathrm{i} k_{\rho} \left(x \cos \varphi + y \sin \varphi\right)}</span>
<span class="sd">        \mathrm{e}^{\mathrm{i} m \varphi + \mathrm{i} k_z z}</span>

<span class="sd">    This function describes a solution to the vector Helmholtz wave</span>
<span class="sd">    equation in the limit of :math:`k_{\rho} \rho \to +\infty`.</span>

<span class="sd">    Args:</span>
<span class="sd">        kz (float, array_like): Z component of the wave vector</span>
<span class="sd">        m (int, array_like): Order</span>
<span class="sd">        x (float or complex, array_like): X coordinate of the source</span>
<span class="sd">        y (float or complex, array_like): Y coordinate of the source</span>
<span class="sd">        phi (float, array_like): Azimuthal angle</span>
<span class="sd">        z (float or complex, array_like): Z coordinate of the source</span>
<span class="sd">        krho (float or complex, array_like): Radial component of the wave vector</span>
<span class="sd">        k (float or complex, array_like): Wave number in the medium</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex, 3-array</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span>
         <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
             <span class="p">[</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">krho</span><span class="p">))</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">krho</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">krho</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))))</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> 
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span>  
                <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">krho</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">krho</span><span class="p">))</span><span class="o">.</span><span class="n">T</span><span class="p">,</span>
                <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">krho</span><span class="p">))</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">krho</span> <span class="o">*</span> <span class="n">x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">)</span> <span class="o">+</span> <span class="n">krho</span> <span class="o">*</span> <span class="n">y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">))))</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span> <span class="o">*</span> 
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz</span> <span class="o">*</span> <span class="n">z</span><span class="p">))</span> <span class="o">*</span>
                <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="o">/</span><span class="mi">4</span><span class="p">)</span> <span class="o">*</span>  
                <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span>
             <span class="p">]</span>
         <span class="p">)</span>
     <span class="p">)</span></div>


<div class="viewcode-block" id="vcw_rL">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.vcw_rL.html#acoustotreams.special.vcw_rL">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">vcw_rL</span><span class="p">(</span><span class="n">kz</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">krho</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span>
<span class="w">     </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Regular longitudinal vector cylindrical wave L</span>

<span class="sd">     The regular vector cylindrical wave is defined by</span>

<span class="sd">     .. math::</span>

<span class="sd">         \mathbf{L}_{k_z m}^{(1)}(x_\rho, \varphi, z)</span>
<span class="sd">        = \left[\frac{k_{\rho}}{k} {J_m(x_\rho)}&#39; \hat{\boldsymbol{\rho}} </span>
<span class="sd">        + \mathrm{i}\frac{m k_{\rho}}{k}\frac{J_m(x_\rho)}{k_{\rho}\rho} \hat{\boldsymbol{\varphi}} </span>
<span class="sd">        + \frac{\mathrm{i} k_z}{k}J_m(x_\rho) \hat{\mathbf{z}} \right] </span>
<span class="sd">        \mathrm{e}^{\mathrm{i} m \varphi + \mathrm{i} k_z z}</span>

<span class="sd">     using :func:`acoustotreams.special.jv_d` and :func:`acoustotreams.special.jv`.</span>

<span class="sd">     This function describes a longitudinal solution to the vector Helmholtz wave</span>
<span class="sd">     equation.</span>

<span class="sd">     Args:</span>
<span class="sd">         kz (float, array_like): Z component of the wave vector</span>
<span class="sd">         m (int, array_like): Order</span>
<span class="sd">         xrho (float or complex, array_like): Radial distance in units of the radial component of the wave number in the medium :math:`k_\rho \rho`</span>
<span class="sd">         phi (float, array_like): Azimuthal angle</span>
<span class="sd">         z (float, array_like): Z coordinate</span>
<span class="sd">         krho (float or complex, array_like): Radial component of the wave vector</span>
<span class="sd">         k (float or complex): Wavenumber in the medium </span>

<span class="sd">     Returns:</span>
<span class="sd">         complex, 3-array</span>
<span class="sd">     &quot;&quot;&quot;</span>
     <span class="c1"># todo: implement for k as array_like</span>
     <span class="n">res</span> <span class="o">=</span> <span class="p">[]</span>
     <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">krr</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">):</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="nb">complex</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="nb">abs</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                   <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                                  <span class="p">[</span>
                       <span class="mf">0.5</span> <span class="o">*</span> <span class="n">krho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span>
                       <span class="mf">0.5</span> <span class="o">*</span> <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">krho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span>
                       <span class="mf">0.</span> 
                       <span class="p">])</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">kz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                   <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
                <span class="k">elif</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                        <span class="p">[</span>
                            <span class="mf">0.</span><span class="p">,</span> 
                            <span class="mf">0.</span><span class="p">,</span> 
                            <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">kz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                            <span class="p">]</span>
                            <span class="p">)</span><span class="o">.</span><span class="n">T</span>
                    <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>      
                <span class="n">val</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span>
                <span class="p">[</span>
                    <span class="n">sc</span><span class="o">.</span><span class="n">jv_d</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">krr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">*</span> <span class="n">krho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span>
                    <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">jv</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">krr</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="o">/</span> <span class="n">krr</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">krho</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span><span class="p">,</span>
                    <span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">kz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="n">k</span> <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">jv</span><span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">krr</span><span class="p">[</span><span class="n">i</span><span class="p">]),</span>
                <span class="p">]</span> 
            <span class="p">)</span><span class="o">.</span><span class="n">T</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">phi</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">kz</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">z</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span>
                <span class="n">res</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>
     <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">res</span><span class="p">)</span></div>


<div class="viewcode-block" id="tl_ssw">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.tl_ssw.html#acoustotreams.special.tl_ssw">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">tl_ssw</span><span class="p">(</span><span class="n">lambda_</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;tl_ssw(lambda_, mu, l, m, kr, theta, phi)</span>
<span class="sd">    </span>
<span class="sd">    Singular translation coefficient of scalar and longitudinal vector spherical waves</span>

<span class="sd">    Definded by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \alpha_{\lambda \mu l m}^{(3)}(x, \theta, \varphi) = (-1)^m \mathrm{i}^{\lambda-l} \sqrt{4\pi (2l+1)(2\lambda+1)} \\</span>
<span class="sd">        \cdot \sum_q \mathrm{i}^{q} \sqrt{2q+1} h^{(1)}_q(x) Y_{q,m-\mu}(\theta,\varphi) \\</span>
<span class="sd">        \cdot \begin{pmatrix}</span>
<span class="sd">            l&amp; \lambda &amp; q \\</span>
<span class="sd">            m &amp; -\mu &amp; \mu-m</span>
<span class="sd">        \end{pmatrix}</span>
<span class="sd">        \begin{pmatrix}</span>
<span class="sd">            l&amp; \lambda &amp; q \\</span>
<span class="sd">            0&amp; 0&amp; 0</span>
<span class="sd">        \end{pmatrix}</span>

<span class="sd">    with the Wigner 3j-symbols (:func:`acoustotreams.special.wigner3j`), the spherical Hankel</span>
<span class="sd">    functions (:func:`acoustotreams.special.spherical_hankel1`), and the spherical harmonics</span>
<span class="sd">    (:func:`acoustotreams.special.sph_harm`). The summation runs over all</span>
<span class="sd">    :math:`q \in \{\lambda + l, \lambda + l - 2, \dots, \max(|\lambda - l|, |\mu - m|)\}`.</span>

<span class="sd">    These coefficients are used to translate from scattered to incident modes.</span>

<span class="sd">    Args:</span>
<span class="sd">        lambda (integer, array_like): Degree of the destination mode</span>
<span class="sd">        mu (integer, array_like): Order of the destination mode</span>
<span class="sd">        l (integer, array_like): Degree of the source mode</span>
<span class="sd">        m (integer, array_like): Order of the source mode</span>
<span class="sd">        x (complex, array_like): Translation in units of the wave number in the medium</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angel</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">cmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">max_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">mu</span><span class="p">))])</span>
    <span class="n">min_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span>  <span class="nb">int</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">sc</span><span class="o">.</span><span class="n">_tl_vsw_helper</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">spherical_hankel1</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">kr</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">lpmv</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span> <span class="o">*</span> <span class="n">pref</span></div>



<div class="viewcode-block" id="tl_ssw_r">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.tl_ssw_r.html#acoustotreams.special.tl_ssw_r">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">tl_ssw_r</span><span class="p">(</span><span class="n">lambda_</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">kr</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;tl_ssw_r(lambda_, mu, l, m, kr, theta, phi)</span>
<span class="sd">    </span>
<span class="sd">    Regular translation coefficient of scalar and longitudinal vector spherical waves</span>

<span class="sd">    Definded by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \alpha_{\lambda \mu l m}^{(1)}(x, \theta, \varphi) = (-1)^m \mathrm{i}^{\lambda-l} \sqrt{4\pi (2l+1)(2\lambda+1)} \\</span>
<span class="sd">        \cdot \sum_q \mathrm{i}^{q} \sqrt{2q+1} j_q(x) Y_{q,m-\mu}(\theta,\varphi) \\</span>
<span class="sd">        \cdot \begin{pmatrix}</span>
<span class="sd">            l&amp; \lambda &amp; q \\</span>
<span class="sd">            m &amp; -\mu &amp; \mu-m</span>
<span class="sd">        \end{pmatrix}</span>
<span class="sd">        \begin{pmatrix}</span>
<span class="sd">            l&amp; \lambda &amp; q \\</span>
<span class="sd">            0&amp; 0&amp; 0</span>
<span class="sd">        \end{pmatrix}</span>

<span class="sd">    with the Wigner 3j-symbols (:func:`acoustotreams.special.wigner3j`), the spherical Bessel</span>
<span class="sd">    functions (:func:`acoustotreams.special.spherical_jn`), and the spherical harmonics</span>
<span class="sd">    (:func:`acoustotreams.special.sph_harm`). The summation runs over all</span>
<span class="sd">    :math:`q \in \{\lambda + l, \lambda + l - 2, \dots, \max(|\lambda - l|, |\mu - m|)\}`.</span>

<span class="sd">    These coefficients are used to translate from scattered to scattered modes and</span>
<span class="sd">    from incident to incident modes.</span>

<span class="sd">    Args:</span>
<span class="sd">        lambda (integer, array_like): Degree of the destination mode</span>
<span class="sd">        mu (integer, array_like): Order of the destination mode</span>
<span class="sd">        l (integer, array_like): Degree of the source mode</span>
<span class="sd">        m (integer, array_like): Order of the source mode</span>
<span class="sd">        x (complex, array_like): Translation in units of the wave number in the medium</span>
<span class="sd">        theta (float or complex, array_like): Polar angle</span>
<span class="sd">        phi (float, array_like): Azimuthal angel</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">pref</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">m</span><span class="p">))</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="mi">2</span> <span class="o">*</span> <span class="n">l</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">lambda_</span> <span class="o">+</span> <span class="mi">1</span><span class="p">))</span> <span class="o">*</span> <span class="n">cmath</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="mf">0.</span>
    <span class="n">max_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">m</span><span class="p">)</span> <span class="o">-</span> <span class="nb">int</span><span class="p">(</span><span class="n">mu</span><span class="p">))])</span>
    <span class="n">min_</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">l</span><span class="p">)</span> <span class="o">+</span> <span class="nb">int</span><span class="p">(</span><span class="n">lambda_</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">p</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">min_</span><span class="p">,</span> <span class="n">max_</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">+=</span> <span class="p">(</span>
            <span class="n">sc</span><span class="o">.</span><span class="n">_tl_vsw_helper</span><span class="p">(</span><span class="n">l</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">lambda_</span><span class="p">,</span> <span class="o">-</span><span class="n">mu</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">spherical_jn</span><span class="p">(</span><span class="n">p</span><span class="p">,</span> <span class="n">kr</span><span class="p">)</span>
            <span class="o">*</span> <span class="n">sc</span><span class="o">.</span><span class="n">lpmv</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="n">p</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="p">)</span>
    <span class="k">return</span> <span class="n">res</span> <span class="o">*</span> <span class="n">pref</span></div>


<div class="viewcode-block" id="tl_scw">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.tl_scw.html#acoustotreams.special.tl_scw">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">tl_scw</span><span class="p">(</span><span class="n">kz1</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">kz2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;tl_scw(kz1, mu, kz2, m, krr, phi, z)</span>
<span class="sd">    </span>
<span class="sd">    Singular translation coefficient of scalar and longitudinal vector cylindrical waves</span>

<span class="sd">    Definded by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \begin{cases}</span>
<span class="sd">            H_{m - \mu}^{(1)}(x_\rho) \mathrm e^{\mathrm i ((m - \mu) \varphi + k_{z,1}z)}</span>
<span class="sd">            &amp; \text{if }k_{z,1} = k_{z,2} \\</span>
<span class="sd">            0 &amp; \text{otherwise}</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    where :math:`H_{m - \mu}^{(1)}` are the Hankel functions (:func:`acoustotreams.special.hankel1`).</span>

<span class="sd">    These coefficients are used to translate from scattered to scattered modes and</span>
<span class="sd">    from incident to incident modes.</span>

<span class="sd">    Args:</span>
<span class="sd">        kz1 (float, array_like): Z component of the destination mode&#39;s wave vector</span>
<span class="sd">        mu (integer, array_like): Order of the destination mode</span>
<span class="sd">        kz2 (float, array_like): Z component of the source mode&#39;s wave vector</span>
<span class="sd">        m (integer, array_like): Order of the source mode</span>
<span class="sd">        xrho (complex, array_like): Translation in radial direction in units of the radial component of the wave number in the medium :math:`k_\rho \rho`</span>
<span class="sd">        phi (float, array_like): Azimuthal angel</span>
<span class="sd">        z (float, array_like): Translation in z direction</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kz1</span> <span class="o">!=</span> <span class="n">kz2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span>
    <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">hankel1</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz1</span> <span class="o">*</span> <span class="n">z</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>



<div class="viewcode-block" id="tl_scw_r">
<a class="viewcode-back" href="../../../generated/generated/acoustotreams.special.tl_scw_r.html#acoustotreams.special.tl_scw_r">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">tl_scw_r</span><span class="p">(</span><span class="n">kz1</span><span class="p">,</span> <span class="n">mu</span><span class="p">,</span> <span class="n">kz2</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">krr</span><span class="p">,</span> <span class="n">phi</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;tl_scw_r(kz1, mu, kz2, m, krr, phi, z)</span>
<span class="sd">    </span>
<span class="sd">    Regular translation coefficient of scalar and longitudinal vector cylindrical waves</span>

<span class="sd">    Definded by</span>

<span class="sd">    .. math::</span>

<span class="sd">        \begin{cases}</span>
<span class="sd">            J_{m - \mu}(x_\rho) \mathrm e^{\mathrm i ((m - \mu) \varphi + k_{z,1}z)}</span>
<span class="sd">            &amp; \text{if }k_{z,1} = k_{z,2} \\</span>
<span class="sd">            0 &amp; \text{otherwise}</span>
<span class="sd">        \end{cases}</span>

<span class="sd">    where :math:`J_{m - \mu}` are the Bessel functions (:func:`acoustotreams.special.jv`).</span>

<span class="sd">    These coefficients are used to translate from scattered to incident modes.</span>

<span class="sd">    Args:</span>
<span class="sd">        kz1 (float, array_like): Z component of the destination mode&#39;s wave vector</span>
<span class="sd">        mu (integer, array_like): Order of the destination mode</span>
<span class="sd">        kz2 (float, array_like): Z component of the source mode&#39;s wave vector</span>
<span class="sd">        m (integer, array_like): Order of the source mode</span>
<span class="sd">        xrho (complex, array_like): Translation in radial direction in units of the radial component of the wave number in the medium :math:`k_\rho \rho`</span>
<span class="sd">        phi (float, array_like): Azimuthal angel</span>
<span class="sd">        z (float, array_like): Translation in z direction</span>

<span class="sd">    Returns:</span>
<span class="sd">        complex</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="n">kz1</span> <span class="o">!=</span> <span class="n">kz2</span><span class="p">:</span>
        <span class="k">return</span> <span class="mf">0.</span><span class="o">+</span><span class="mf">0.</span><span class="n">j</span>
    <span class="k">return</span> <span class="n">sc</span><span class="o">.</span><span class="n">jv</span><span class="p">(</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">,</span> <span class="n">krr</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="p">((</span><span class="n">m</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">*</span> <span class="n">phi</span> <span class="o">+</span> <span class="n">kz1</span> <span class="o">*</span> <span class="n">z</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="Main">
        <div class="sphinxsidebarwrapper">
<h3><a href="../../../index.html">Table of Contents</a></h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../gettingstarted.html">Getting started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../intro.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory.html">Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../acoustotreams.html">Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../dev.html">Development and contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../about.html">About</a></li>
</ul>

<search id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</search>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="Related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../../index.html">acoustotreams 0.2.13 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../../index.html" >Module code</a> &#187;</li>
        <li class="nav-item nav-item-this"><a href="">acoustotreams.special._wavesacoustics</a></li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
    &#169; Copyright 2024, Nikita Ustimenko.
      Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 9.0.4.
    </div>
  </body>
</html>